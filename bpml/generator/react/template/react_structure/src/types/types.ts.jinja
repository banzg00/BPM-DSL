// Entity type definitions
{% for entity in entities %}
export interface {{ entity.name }} {
  id?: number;
{% for attr in entity.attributes %}  {{ attr.name }}: {% if attr.type | is_enum_type %}{{ entity.name }}{{ attr.name | capitalize_str }}{% else %}{{ attr.type | format_type }}{% endif %};
{% endfor %}
}

{% if entity.attributes %}{% for attr in entity.attributes %}{% if attr.type | is_enum_type %}
export enum {{ entity.name }}{{ attr.name | capitalize_str }} {
{% for value in attr.type | get_enum_values %}  {{ value }} = '{{ value }}',
{% endfor %}}

{% endif %}{% endfor %}{% endif %}
{% endfor %}

// Process-related type definitions
export enum ProcessStatus {
  RUNNING = 'RUNNING',
  COMPLETED = 'COMPLETED',
  TERMINATED = 'TERMINATED',
  SUSPENDED = 'SUSPENDED'
}

export enum TaskStatus {
  PENDING = 'PENDING',
  IN_PROGRESS = 'IN_PROGRESS',
  COMPLETED = 'COMPLETED',
  CANCELLED = 'CANCELLED'
}

export interface EntityReference {
  entityType: string;
  entityId: number;
}

export interface ProcessInstance {
  id: number;
  processName: string;
  currentState: string;
  status: ProcessStatus;
  initiatedBy: string;
  processVariables: Record<string, any>;
  startedAt: string;
  completedAt?: string;
  terminatedReason?: string;
  suspendedAt?: string;
  suspendedReason?: string;
  suspendedBy?: string;
  linkedEntities?: EntityReference[];
}

export interface TaskInstance {
  id: number;
  processInstanceId: number;
  taskName: string;
  assignedRole: string;
  assignedUser?: string;
  status: TaskStatus;
  entityId?: number;
  entityTypes?: string[]; // List of entity types this task affects
  taskData: Record<string, any>;
  createdAt: string;
  claimedAt?: string;
  completedAt?: string;
  completedBy?: string;
  // Escalation fields
  originalAssignedRole?: string;
  originalAssignedUser?: string;
  escalatedBy?: string;
  escalatedToRole?: string;
  escalationReason?: string;
  escalatedAt?: string;
  isEscalated?: boolean;
}

export interface AvailableTransition {
  transitionName: string;
  fromState: string;
  toState: string;
  requiredRole: string;
}

export interface TransitionHistory {
  id: number;
  processInstanceId: number;
  transitionName: string;
  fromState: string;
  toState: string;
  executedBy: string;
  executedByRole?: string;
  transitionData?: Record<string, any>;
  executedAt: string;
}

export interface StartProcessRequest {
  initiatedBy: string;
  processVariables?: Record<string, any>;
  entities?: EntityReference[];
}

export interface ExecuteTransitionRequest {
  executedBy: string;
  userRole: string;
  comments?: string;
}

export interface EscalateTaskRequest {
  userId: string;
  targetRole: string;
  reason: string;
}

export interface RoleHierarchy {
  [supervisorRole: string]: string[];  // supervisor -> list of supervised roles
}
